<html>
<head>
<title>Patient Medical Record details</title>
<link rel="stylesheet" href="styles.css">
<!-- CSS only -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6" crossorigin="anonymous">
</head>
<header>
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    <a class="navbar-brand lis" href="#">The City Hospital</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse lis" id="navbarNav">
      <ul class="navbar-nav">
        <li class="nav-item active">
          <a class="nav-link" href="/">Home</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/PatientRegistration">Add Personal details</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/patient_examine">Add examination details</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/DoctorMod">Doctor module</a>
        </li>
      </ul>
    </div>

    <ul class="navbar-nav px-3">
      <li class="nav-item text-nowrap">
        <a class="nav-link" href="/">Sign out</a>
      </li>
    </ul>
  </nav>

</header>
    <body>

        <script src="https://cdn.jsdelivr.net/npm/web3@1.2.8/dist/web3.js"></script>
    <script>

      var account;
    	window.addEventListener('load', async () => {


    		if (typeof window.ethereum !== 'undefined') {
    			console.log("MetaMask is Available :) !");
    			}

    		// Modern DApp browsers
    		if (window.ethereum) {
    			window.web3 = new Web3(ethereum);

    			// To prevent the page reloading when the MetaMask network changes
    			ethereum.autoRefreshOnNetworkChange = false;

    			// To Capture the account details from MetaMask
    			const accounts = await ethereum.enable();
    			account = accounts[0];
    			console.log(account);

    			}
    		// Legacy DApp browsers
    		else if (window.web3) {
    			window.web3 = new Web3(web3.currentProvider);

    			}
    		// Non-DApp browsers
    		else {
    			console.log('Non-Ethereum browser detected. Please install MetaMask');
    			}

    			});

        var abi = [
          {
            "constant": false,
            "inputs": [
              {
                "internalType": "uint256",
                "name": "patient_id",
                "type": "uint256"
              },
              {
                "internalType": "string",
                "name": "_applicable",
                "type": "string"
              },
              {
                "internalType": "uint64",
                "name": "_policy_no",
                "type": "uint64"
              },
              {
                "internalType": "string",
                "name": "_insurer",
                "type": "string"
              },
              {
                "internalType": "string",
                "name": "_policy_type",
                "type": "string"
              },
              {
                "internalType": "string",
                "name": "_policy_limit",
                "type": "string"
              }
            ],
            "name": "insurance_details",
            "outputs": [],
            "payable": false,
            "stateMutability": "nonpayable",
            "type": "function"
          },
          {
            "constant": true,
            "inputs": [
              {
                "internalType": "uint256",
                "name": "patient_id",
                "type": "uint256"
              }
            ],
            "name": "get_insurance",
            "outputs": [
              {
                "internalType": "string",
                "name": "",
                "type": "string"
              },
              {
                "internalType": "uint64",
                "name": "",
                "type": "uint64"
              },
              {
                "internalType": "string",
                "name": "",
                "type": "string"
              },
              {
                "internalType": "string",
                "name": "",
                "type": "string"
              },
              {
                "internalType": "string",
                "name": "",
                "type": "string"
              }
            ],
            "payable": false,
            "stateMutability": "view",
            "type": "function"
          },
          {
            "constant": false,
            "inputs": [
              {
                "internalType": "uint256",
                "name": "patient_id",
                "type": "uint256"
              },
              {
                "internalType": "string",
                "name": "_complaints",
                "type": "string"
              },
              {
                "internalType": "string",
                "name": "_duration",
                "type": "string"
              }
            ],
            "name": "present_illness",
            "outputs": [],
            "payable": false,
            "stateMutability": "nonpayable",
            "type": "function"
          },
          {
            "constant": true,
            "inputs": [
              {
                "internalType": "uint256",
                "name": "patient_id",
                "type": "uint256"
              }
            ],
            "name": "get_present_illness",
            "outputs": [
              {
                "internalType": "string",
                "name": "",
                "type": "string"
              },
              {
                "internalType": "string",
                "name": "",
                "type": "string"
              }
            ],
            "payable": false,
            "stateMutability": "view",
            "type": "function"
          },
          {
            "constant": false,
            "inputs": [
              {
                "internalType": "uint256",
                "name": "patient_id",
                "type": "uint256"
              },
              {
                "internalType": "string",
                "name": "_family_history",
                "type": "string"
              },
              {
                "internalType": "string",
                "name": "_personal_history",
                "type": "string"
              },
              {
                "internalType": "string",
                "name": "_drug_history",
                "type": "string"
              }
            ],
            "name": "past_illness",
            "outputs": [],
            "payable": false,
            "stateMutability": "nonpayable",
            "type": "function"
          },
          {
            "constant": true,
            "inputs": [
              {
                "internalType": "uint256",
                "name": "patient_id",
                "type": "uint256"
              }
            ],
            "name": "get_past_illness",
            "outputs": [
              {
                "internalType": "string",
                "name": "",
                "type": "string"
              },
              {
                "internalType": "string",
                "name": "",
                "type": "string"
              },
              {
                "internalType": "string",
                "name": "",
                "type": "string"
              }
            ],
            "payable": false,
            "stateMutability": "view",
            "type": "function"
          },
          {
            "constant": false,
            "inputs": [
              {
                "internalType": "uint256",
                "name": "patient_id",
                "type": "uint256"
              },
              {
                "internalType": "string",
                "name": "_diag_summary",
                "type": "string"
              },
              {
                "internalType": "string",
                "name": "_prescription",
                "type": "string"
              }
            ],
            "name": "func_diagnosis",
            "outputs": [],
            "payable": false,
            "stateMutability": "nonpayable",
            "type": "function"
          },
          {
            "constant": true,
            "inputs": [
              {
                "internalType": "uint256",
                "name": "patient_id",
                "type": "uint256"
              }
            ],
            "name": "get_func_diagnosis",
            "outputs": [
              {
                "internalType": "string",
                "name": "",
                "type": "string"
              },
              {
                "internalType": "string",
                "name": "",
                "type": "string"
              }
            ],
            "payable": false,
            "stateMutability": "view",
            "type": "function"
          },
          {
            "constant": false,
            "inputs": [
              {
                "internalType": "uint256",
                "name": "patient_id",
                "type": "uint256"
              },
              {
                "internalType": "string",
                "name": "_treatment",
                "type": "string"
              },
              {
                "internalType": "string",
                "name": "_date_treatment",
                "type": "string"
              },
              {
                "internalType": "uint256",
                "name": "_doctor_id",
                "type": "uint256"
              },
              {
                "internalType": "uint256",
                "name": "_hospital_id",
                "type": "uint256"
              },
              {
                "internalType": "string",
                "name": "_discharge",
                "type": "string"
              },
              {
                "internalType": "string",
                "name": "_follow_up",
                "type": "string"
              }
            ],
            "name": "treatment_summary",
            "outputs": [],
            "payable": false,
            "stateMutability": "nonpayable",
            "type": "function"
          },
          {
            "constant": true,
            "inputs": [
              {
                "internalType": "uint256",
                "name": "patient_id",
                "type": "uint256"
              }
            ],
            "name": "get_treatment_summary",
            "outputs": [
              {
                "internalType": "string",
                "name": "",
                "type": "string"
              },
              {
                "internalType": "string",
                "name": "",
                "type": "string"
              },
              {
                "internalType": "uint256",
                "name": "",
                "type": "uint256"
              },
              {
                "internalType": "uint256",
                "name": "",
                "type": "uint256"
              },
              {
                "internalType": "string",
                "name": "",
                "type": "string"
              },
              {
                "internalType": "string",
                "name": "",
                "type": "string"
              }
            ],
            "payable": false,
            "stateMutability": "view",
            "type": "function"
          }
        ];
        var contractaddress = '0xA47D19819773da91a04b167358d95D3c3BAAa56c';

				function submit_details() {
            var myContract = new web3.eth.Contract(abi,contractaddress, {from: account, gasPrice: '5000000', gas: '5000000'});
			var id = document.getElementById("id1").value;
			var ids1 = document.getElementById("appl").value;
			var ids2 = document.getElementById("pono").value;
			var ids3 = document.getElementById("ins").value;
			var ids4 = document.getElementById("type").value;
			var ids5 = document.getElementById("lim").value;

			var pd1 = document.getElementById("com").value;
			var pd2 = document.getElementById("dur").value;

			var pad1 = document.getElementById("fam").value;
			var pad2 = document.getElementById("per").value;
			var pad3 = document.getElementById("drug").value;

			var dd1 = document.getElementById("diag").value;
			var dd2 = document.getElementById("pre").value;

			var td1 = document.getElementById("treat").value;
			var td2 = document.getElementById("date").value;
			var td3 = document.getElementById("doc").value;
			var td4 = document.getElementById("hos").value;
			var td5 = document.getElementById("dis").value;
			var td6 = document.getElementById("fol").value;




             var result = myContract.methods.insurance_details(id,ids1,ids2,ids3,ids4,ids5).send(function (err, result) {

                if (err) { console.log(err); }

                });

             var result = myContract.methods.present_illness(id,pd1,pd2).send(function (err, result) {

                if (err) { console.log(err); }

                });


             var result = myContract.methods.past_illness(id,pad1,pad2,pad3).send(function (err, result) {

                if (err) { console.log(err); }

                });


             var result = myContract.methods.func_diagnosis(id,dd1,dd2).send(function (err, result) {

                if (err) { console.log(err); }

                });


             var result = myContract.methods.treatment_summary(id,td1,td2,td3,td4,td5,td6).send(function (err, result) {

                if (err) { console.log(err); }

                });
        }

        </script>

       <h2 class="doct">Record</h2>
       <form class="doct" action="/" method="post">
       <div class="form-group col-md-4">
         <label for="id1">Enter Patient id:</label>
         <input type="text" class="form-control frm" id="id1" placeholder="Patient id">
       </div>


       </form>

        <h2 class="doct">Insurance Details</h2>

  <form class="doct" action="/" method="post">
  <div class="form-group col-md-4">
    <label for="appl">Is Insurance applicable?(yes/no):</label>
    <input type="text" class="form-control frm" id="appl" placeholder="Is insurance applicable">
  </div>
  <div class="form-group col-md-4">
    <label for="pono">Policy no:</label>
    <input type="text" class="form-control frm" id="pono" placeholder="Policy no">
  </div>
  <div class="form-group col-md-4">
    <label for="ins">Insurer:</label>
    <input type="text" class="form-control frm" id="ins" placeholder="Insurer">
  </div>
  <div class="form-group col-md-4">
    <label for="type">Policy type:</label>
    <input type="text" class="form-control frm" id="type" placeholder="Policy type">
  </div>
  <div class="form-group col-md-4">
    <label for="lim">Policy limit:</label>
    <input type="text" class="form-control frm" id="lim" placeholder="Policy limit">
  </div>
  </form>
	<h2 class="doct"> Present Illness Details</h2>

  <form class="doct" action="/" method="post">
  <div class="form-group col-md-4">
    <label for="com">Complaints:</label>
    <input type="text" class="form-control frm" id="com" placeholder="Complaints">
  </div>
  <div class="form-group col-md-4">
    <label for="dur">Duration:</label>
    <input type="text" class="form-control frm" id="dur" placeholder="Duration">
  </div>

  </form>
	<h2 class="doct"> Past Illness Details</h2>

  <form class="doct" action="/" method="post">
  <div class="form-group col-md-4">
    <label for="com">Complaints:</label>
    <input type="text" class="form-control frm" id="fam" placeholder="Family History">
  </div>
  <div class="form-group col-md-4">
    <label for="dur">Duration:</label>
    <input type="text" class="form-control frm" id="per" placeholder="Personal History">
  </div>
  <div class="form-group col-md-4">
    <label for="drug">Drug history:</label>
    <input type="text" class="form-control frm" id="drug" placeholder="Drug history">
  </div>

  </form>
	<h2 class="doct">Provisional Diagnosis Details</h2>


  <form class="doct" action="/" method="post">
  <div class="form-group col-md-4">
    <label for="com">Diagnosis Summary:</label>
    <input type="text" class="form-control frm" id="diag" placeholder="Diagnosis Summary">
  </div>
  <div class="form-group col-md-4">
    <label for="dur">Prescription:</label>
    <input type="text" class="form-control frm" id="pre" placeholder="Prescription">
  </div>


  </form>


        <h2 class="doct">Treatment Summary</h2>


  <form class="doct" action="/" method="post">
  <div class="form-group col-md-4">
    <label for="treat">Treatment:</label>
    <input type="text" class="form-control frm" id="treat" placeholder="Treatment">
  </div>
  <div class="form-group col-md-4">
    <label for="date">Date:</label>
    <input type="text" class="form-control frm" id="date" placeholder="Date">
  </div>
  <div class="form-group col-md-4">
    <label for="doc">Treatment doctor id:</label>
    <input type="text" class="form-control frm" id="doc" placeholder="Treatment Doctor id">
  </div>
  <div class="form-group col-md-4">
    <label for="hos">Treatment Policy hospital:</label>
    <input type="text" class="form-control frm" id="hos" placeholder="Treatment hospital">
  </div>
  <div class="form-group col-md-4">
    <label for="dis">Discharge:</label>
    <input type="text" class="form-control frm" id="dis" placeholder="Discharge">
  </div>
  <div class="form-group col-md-4">
    <label for="lim">Follow up:</label>
    <input type="text" class="form-control frm" id="fol" placeholder="Follow up">
  </div>
  <a class="btn btn-primary bts1" onclick="submit_details()">Submit</a>
  <a href="/PatientMod" class="btn btn-primary bts1">Back</a>
  </form>



    </body>
</html>
